---
schema: EconSchema
version: 1
aspectRatio: 1.3
params:
  - {name: x1, value: 4, min: 0.5, max: 9, round: 0.5}
  - {name: x2, value: 4, min: 0.5, max: 9, round: 0.5}


# consumption levels on 45° line
  - {name: c1, value: 1}
  - {name: c2, value: 2}
  - {name: c3, value: 3}
  - {name: c4, value: 4}
  - {name: c5, value: 5}
  - {name: c6, value: 6}
  - {name: c7, value: 7}
  - {name: c8, value: 8}
  - {name: c9, value: 9}

  - {name: s, value: 6}


# which utility function
  - {name: whichU, value: 0}



calcs:

# utility at selected bundle
  u0: ((params.x1))*((params.x2))
  u1: ((params.x1)^(2))*((params.x2)^(1))
  u2: ((params.x1)^(1))*((params.x2)^(2))
  u3: ((params.x1)*(params.x2))+((params.s)*((params.x1)+(params.x2)))

# MRS at selected bundle
  MRS0: (params.x2)/(params.x1)
  MRS1: (2)*(params.x2)/(params.x1)
  MRS2: (0.5)*(params.x2)/(params.x1)
  MRS3: ((params.x2)+(params.s))/((params.x1)+(params.s))

# utility levels (params.whichU=0)
  u10: ((params.c1))*((params.c1))
  u20: ((params.c2))*((params.c2))
  u30: ((params.c3))*((params.c3))
  u40: ((params.c4))*((params.c4))
  u50: ((params.c5))*((params.c5))
  u60: ((params.c6))*((params.c6))
  u70: ((params.c7))*((params.c7))
  u80: ((params.c8))*((params.c8))
  u90: ((params.c9))*((params.c9))

# utility levels (params.whichU=1)
  u11: ((params.c1)^(2))*((params.c1))
  u21: ((params.c2)^(2))*((params.c2))
  u31: ((params.c3)^(2))*((params.c3))
  u41: ((params.c4)^(2))*((params.c4))
  u51: ((params.c5)^(2))*((params.c5))
  u61: ((params.c6)^(2))*((params.c6))
  u71: ((params.c7)^(2))*((params.c7))
  u81: ((params.c8)^(2))*((params.c8))
  u91: ((params.c9)^(2))*((params.c9))

# utility levels (params.whichU=2)
  u12: ((params.c1))*((params.c1)^(2))
  u22: ((params.c2))*((params.c2)^(2))
  u32: ((params.c3))*((params.c3)^(2))
  u42: ((params.c4))*((params.c4)^(2))
  u52: ((params.c5))*((params.c5)^(2))
  u62: ((params.c6))*((params.c6)^(2))
  u72: ((params.c7))*((params.c7)^(2))
  u82: ((params.c8))*((params.c8)^(2))
  u92: ((params.c9))*((params.c9)^(2))

# utility levels (params.whichU=3)
  u13: ((params.c1)*(params.c1))+((params.s)*((params.c1)+(params.c1)))
  u23: ((params.c2)*(params.c2))+((params.s)*((params.c2)+(params.c2)))
  u33: ((params.c3)*(params.c3))+((params.s)*((params.c3)+(params.c3)))
  u43: ((params.c4)*(params.c4))+((params.s)*((params.c4)+(params.c4)))
  u53: ((params.c5)*(params.c5))+((params.s)*((params.c5)+(params.c5)))
  u63: ((params.c6)*(params.c6))+((params.s)*((params.c6)+(params.c6)))
  u73: ((params.c7)*(params.c7))+((params.s)*((params.c7)+(params.c7)))
  u83: ((params.c8)*(params.c8))+((params.s)*((params.c8)+(params.c8)))
  u93: ((params.c9)*(params.c9))+((params.s)*((params.c9)+(params.c9)))




layout:
  OneGraphPlusSidebar:
    graph:
      xAxis:
        max: 9.5
        ticks: 0
      yAxis:
        max: 9.5
        ticks: 0



      objects:

      - Label:
            coordinates: [9.5, 0]
            text: "` \\\\text{Unità di $X$} `"
            position: l
      - Label:
            coordinates: [0, 9.5]
            text: "` \\\\text{Unità di $Y$}  `"

# bundle
      - Point:
          coordinates: [params.x1, params.x2]
          droplines:
            horizontal: params.x2.toFixed(1)
            vertical: params.x1.toFixed(1)
          color: Blue
          r: 4
          strokeWidth: 0.5
          draggable: true
          # label:
          #   text: "` \\\\large{A} `"
          #   bgcolor: none


# Indifference curve at bundle
      - Curve:
          fn: ((calcs.u0)/((x)^(1)))^(1/(1))
          color: Black
          strokeWidth: 1.5
          show: params.whichU == 0 
      - Curve:
          fn: ((calcs.u1)/((x)^(2)))^(1/(1))
          color: Black
          strokeWidth: 1.5
          show: params.whichU == 1 
      - Curve:
          fn: ((calcs.u2)/((x)^(1)))^(1/(2))
          color: Black
          strokeWidth: 1.5
          show: params.whichU == 2
      - Curve:
          fn: ((calcs.u3)-((params.s)*(x)))/((x)+(params.s))
          color: Black
          strokeWidth: 1.5
          show: params.whichU == 3
      

# Indifference Map (params.whichU=0)
      - Curve:
          fn:   ((calcs.u10)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u20)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.15
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u30)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.05
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u40)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u50)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u60)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u70)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u80)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 
      - Curve:
          fn:   ((calcs.u90)/((x)^(1)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 0 


# Indifference Map (params.whichU=1)
      - Curve:
          fn:   ((calcs.u11)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u21)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.15
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u31)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.05
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u41)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u51)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u61)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u71)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u81)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 
      - Curve:
          fn:   ((calcs.u91)/((x)^(2)))^(1/(1))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 1 


# Indifference Map (params.whichU=2)
      - Curve:
          fn:   ((calcs.u12)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u22)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.15
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u32)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.05
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u42)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u52)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u62)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u72)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u82)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 
      - Curve:
          fn:   ((calcs.u92)/((x)^(1)))^(1/(2))
          color: Grey
          strokeWidth: 0.25
          min: 0.01
          show: params.whichU == 2 


# Indifference Map (params.whichU=3)
      - Curve:
          fn:   ((calcs.u13)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u23)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u33)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u43)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u53)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u63)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u73)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u83)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 
      - Curve:
          fn:   ((calcs.u93)-((params.s)*(x)))/((x)+(params.s))
          color: Grey
          strokeWidth: 0.25
          min: 0.04
          show: params.whichU == 3 



# tangent at bundle
      - Line:
          point: [params.x1,params.x2]
          slope: -(calcs.MRS0)
          color: Blue
          min: params.x1-100
          max: params.x1+100
          strokeWidth: 0.7
          lineStyle: dashed
          show: params.whichU == 0
      - Line:
          point: [params.x1,params.x2]
          slope: -(calcs.MRS1)
          color: Blue
          min: params.x1-100
          max: params.x1+100
          strokeWidth: 0.7
          lineStyle: dashed
          show: params.whichU == 1
      - Line:
          point: [params.x1,params.x2]
          slope: -(calcs.MRS2)
          color: Blue
          min: params.x1-100
          max: params.x1+100
          strokeWidth: 0.7
          lineStyle: dashed
          show: params.whichU == 2
      - Line:
          point: [params.x1,params.x2]
          slope: -(calcs.MRS3)
          color: Blue
          min: params.x1-100
          max: params.x1+100
          strokeWidth: 0.7
          lineStyle: dashed
          show: params.whichU == 3






    sidebar:
      controls:
      - title: Utilità marginali e saggio marginale di sostituzione
        radioGroup:
          param: whichU
          options:
            - $U=XY$
            - $U=X^2Y$
            - $U=XY^2$
            - $U=XY+4(X+Y)$
        description: Selezionare una funzione di utilità e poi un paniere per calcolare utilità marginali e 
                    saggio marginale di sostituzione di 𝑋 con 𝑌 in quel paniere.

      - title: "` `"
        divs:
          - html: "`  `"
          - html: "` In questo caso abbiamo $MU_X=Y$ e $MU_Y=X$, quindi 
                    $$ MRS_{XY} = \\\\dfrac{Y}{X} $$  `"
        sliders:
        - param: x1
          label: X
        - param: x2
          label: Y
        show: params.whichU == 0

      - title: "` `"
        divs:
          - html: "`  `"
          - html: "` In questo caso abbiamo $MU_X=2XY$ e $MU_Y=X^2$, quindi 
                    $$ MRS_{XY} = \\\\dfrac{2Y}{X} $$  `"
        sliders:
        - param: x1
          label: X
        - param: x2
          label: Y
        show: params.whichU == 1

      - title: "` `"
        divs:
          - html: "`  `"
          - html: "` In questo caso abbiamo $MU_X=Y^2$ e $MU_Y=2XY$, quindi 
                    $$ MRS_{XY} = \\\\dfrac{Y}{2X} $$  `"
        sliders:
        - param: x1
          label: X
        - param: x2
          label: Y
        show: params.whichU == 2

      - title: "` `"
        divs:
          - html: "`  `"
          - html: "` In questo caso abbiamo $MU_X=Y+5$ e $MU_Y=X+5$, quindi 
                    $$ MRS_{XY} = \\\\dfrac{Y+5}{X+5} $$  `"
        sliders:
        - param: x1
          label: X
        - param: x2
          label: Y
        show: params.whichU == 3









    explanation:

        divs:

          - html: "` `"

          - html: "` In corrispondenza del paniere $(${params.x1},${params.x2})$
                      le utilità marginali sono $MU_X=${params.x2}$ e $MU_Y=${params.x1}$.
                     Il saggio marginale di sostituzione di $X$ con $Y$ è quindi
                     $MRS_{XY} = ${params.x2} / ${params.x1} = ${calcs.MRS0.toFixed(2)}. $
                     `"
            show: params.whichU == 0

          - html: "` In corrispondenza del paniere $(${params.x1},${params.x2})$
                      le utilità marginali sono $MU_X=${(2)*(params.x1)*(params.x2)}$ e
                      $MU_Y=${(params.x1)*(params.x1)}$.
                     Il saggio marginale di sostituzione di $X$ con $Y$ è quindi
                     $MRS_{XY} = 2 ${params.x2} / ${params.x1} = ${calcs.MRS1.toFixed(2)}. $
                     `"
            show: params.whichU == 1

          - html: "` In corrispondenza del paniere $(${params.x1},${params.x2})$
                      le utilità marginali sono $MU_X=${(params.x2)*(params.x2)}$
                      e $MU_Y=${(2)*(params.x1)*(params.x2)}$.
                     Il saggio marginale di sostituzione di $X$ con $Y$ è quindi
                     $MRS_{XY} = ${params.x2} / (2 \\\\times ${params.x1} ) = ${calcs.MRS2.toFixed(2)}. $
                     `"
            show: params.whichU == 2

          - html: "` In corrispondenza del paniere $(${params.x1},${params.x2})$
                      le utilità marginali sono $MU_X=${(params.x2)+(params.s)}$
                      e $MU_Y=${(params.x1)+(params.s)}$.
                     Il saggio marginale di sostituzione di $X$ con $Y$ è quindi
                     $MRS_{XY} = (${params.x2}+${params.s}) / (${params.x1}+${params.s}) = ${calcs.MRS3.toFixed(2)}. $
                     `"
            show: params.whichU == 3













